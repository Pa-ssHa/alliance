<!DOCTYPE html>
<html lang="en" xmlns:th="http://thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Новое объявление</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/css/styles.css">
</head>
<body>
<div class="container">

    <div th:insert="~{navbar.html}"></div>

    <h1>Новое объявление</h1>

    <form th:method="POST" th:action="@{/realty/advertisementSale}" th:object="${newAdvertisementSale}"
          enctype="multipart/form-data">
        <ul>
            <li>
                <label for="title">Введите название</label>
                <input type="text" th:field="*{title}" id="title" class="form-control">
                <br>
                <label for="description">Введите описание</label>
                <input type="text" th:field="*{description}" id="description" class="form-control">
                <br>
                <label for="price">Введите цену</label>
                <input type="number" step="0.01" th:field="*{price}" id="price" class="form-control">
                <br>
                <label for="images">Изображения:</label>
                <input type="file" th:field="*{images}" id="images" multiple accept="image/*" class="form-control">
                <br>
                <label>Выберите главное изображение:</label>
                <div id="imagePreview"></div>
            </li>
        </ul>
        <div>
            <input type="submit" value="Создать" class="btn btn-success">
        </div>
    </form>

    <form th:method="GET" th:action="@{/realty}">
        <input type="submit" value="Вернуться на главную" class="btn btn-secondary"/>
    </form>

    <script>
        // Скрипт для предпросмотра изображений и выбора главного
        document.getElementById('images').addEventListener('change', function (event) {
            const preview = document.getElementById('imagePreview');
            preview.innerHTML = ''; // Очищаем предпросмотр

            const files = event.target.files;
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                const reader = new FileReader();

                reader.onload = function (e) {
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    img.classList.add('img-thumbnail', 'm-2');
                    img.style.width = '150px';

                    const radio = document.createElement('input');
                    radio.type = 'radio';
                    radio.name = 'mainImage';
                    radio.value = i;
                    radio.classList.add('form-check-input', 'm-2');

                    const label = document.createElement('label');
                    label.classList.add('form-check-label');
                    label.appendChild(radio);
                    label.appendChild(img);

                    preview.appendChild(label);
                };

                reader.readAsDataURL(file);
            }
        });
    </script>


</div>
</body>
</html>